<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>密钥生成器</title>
    <style>
        /* 全局样式 */
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff; /* 浅蓝色背景 */
            color: #333; /* 深灰色文字 */
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* 容器样式 */
        .container {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            background-color: #fff; /* 白色背景 */
            border-radius: 8px; /* 圆角边框 */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 阴影效果 */
            text-align: center;
        }

        /* 标题样式 */
        h1 {
            font-size: 2rem; /* 标题字体大小 */
            color: #4CAF50; /* 绿色标题 */
            margin-bottom: 20px;
        }

        /* 段落样式 */
        p {
            font-size: 1rem; /* 段落字体大小 */
            margin-bottom: 20px;
        }

        /* 按钮样式 */
        button {
            padding: 12px 24px; /* 按钮内边距 */
            font-size: 1rem; /* 按钮字体大小 */
            background-color: #4CAF50; /* 绿色按钮 */
            color: #fff; /* 白色文字 */
            border: none;
            border-radius: 4px; /* 圆角按钮 */
            cursor: pointer; /* 鼠标悬停时显示手型 */
            transition: background-color 0.3s ease; /* 背景颜色过渡效果 */
        }

        /* 按钮悬停样式 */
        button:hover {
            background-color: #45a049; /* 鼠标悬停时的按钮颜色 */
        }

        /* 输出区域样式 */
        pre {
            background-color: #f4f4f4; /* 浅灰色背景 */
            padding: 15px;
            border: 1px solid #ddd; /* 浅灰色边框 */
            border-radius: 4px; /* 圆角边框 */
            margin-top: 20px;
            white-space: pre-wrap;
            font-size: 0.8rem; /* 字体大小缩小到 0.8rem */
            color: #333; /* 深灰色文字 */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>密钥生成器</h1>
        <p>点击按钮生成密钥</p>
        <button onclick="generateAndEncrypt()">生成密钥</button>
        <pre id="output"></pre>
    </div>

    <script>
        /**
         * 生成原始密钥
         * @returns {string} 格式为 YYYYMMDD 的日期字符串
         */
        function generateKey() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            return `${year}${month}${day}`;
        }

        /**
         * 生成随机长度的随机字符串
         * @param {number} minLength - 最小长度
         * @param {number} maxLength - 最大长度
         * @returns {string} 随机字符串
         */
        function generateRandomString(minLength, maxLength) {
            const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            const length = Math.floor(Math.random() * (maxLength - minLength + 1)) + minLength;
            let result = '';
            for (let i = 0; i < length; i++) {
                const randomIndex = Math.floor(Math.random() * characters.length);
                result += characters[randomIndex];
            }
            return result;
        }

        /**
         * 简化的 Base64 加密函数
         * @param {string} value - 需要加密的值
         * @returns {string} 加密后的 Base64 字符串
         */
        function simpleBase64Encrypt(value) {
            // 添加随机长度的随机字符串（最小 5 位，最大 15 位）
            const randomString = generateRandomString(5, 15);
            const combinedString = randomString + value;
            // Base64 编码
            return btoa(combinedString);
        }

        /**
         * 在编码后的字符串末尾添加随机长度的随机字符串
         * @param {string} encodedString - 已编码的字符串
         * @returns {string} 添加随机后缀后的字符串
         */
        function appendRandomSuffix(encodedString) {
            // 添加随机长度的随机后缀（最小 3 位，最大 8 位）
            const randomSuffix = generateRandomString(3, 8);
            return encodedString + randomSuffix;
        }

        /**
         * 主函数：生成并加密密钥
         */
        function generateAndEncrypt() {
            const key = generateKey();
            const encryptedKey = simpleBase64Encrypt(key);
            const finalKey = appendRandomSuffix(encryptedKey);
            document.getElementById('output').textContent = `${finalKey}`;
        }
    </script>
</body>
</html>
